<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-knowledge-base/jobnik/README" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">README | Infra Portal</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mapcolonies.github.io/infra-portal/pr-preview/pr-45/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://mapcolonies.github.io/infra-portal/pr-preview/pr-45/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://mapcolonies.github.io/infra-portal/pr-preview/pr-45/docs/knowledge-base/jobnik"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="README | Infra Portal"><meta data-rh="true" name="description" content="automated factory"><meta data-rh="true" property="og:description" content="automated factory"><link data-rh="true" rel="icon" href="/infra-portal/pr-preview/pr-45/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mapcolonies.github.io/infra-portal/pr-preview/pr-45/docs/knowledge-base/jobnik"><link data-rh="true" rel="alternate" href="https://mapcolonies.github.io/infra-portal/pr-preview/pr-45/docs/knowledge-base/jobnik" hreflang="en"><link data-rh="true" rel="alternate" href="https://mapcolonies.github.io/infra-portal/pr-preview/pr-45/docs/knowledge-base/jobnik" hreflang="x-default"><link rel="stylesheet" href="/infra-portal/pr-preview/pr-45/assets/css/styles.abde83b5.css">
<script src="/infra-portal/pr-preview/pr-45/assets/js/runtime~main.1b39c6c9.js" defer="defer"></script>
<script src="/infra-portal/pr-preview/pr-45/assets/js/main.d74ec590.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/infra-portal/pr-preview/pr-45/"><div class="navbar__logo"><img src="/infra-portal/pr-preview/pr-45/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/infra-portal/pr-preview/pr-45/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Infra Portal</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/infra-portal/pr-preview/pr-45/docs/knowledge-base">Knowledge Base</a><a class="navbar__item navbar__link" href="/infra-portal/pr-preview/pr-45/docs/guides">Guides</a><a class="navbar__item navbar__link" href="/infra-portal/pr-preview/pr-45/docs/what-we-did">What We Did</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/MapColonies/infra-portal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/infra-portal/pr-preview/pr-45/docs/knowledge-base">Knowledge Base</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/infra-portal/pr-preview/pr-45/docs/knowledge-base/config-management">Config Management</a><button aria-label="Expand sidebar category &#x27;Config Management&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" href="/infra-portal/pr-preview/pr-45/docs/knowledge-base/jobnik">Jobnik</a><button aria-label="Collapse sidebar category &#x27;Jobnik&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/infra-portal/pr-preview/pr-45/docs/knowledge-base/jobnik/boilerplate">Boilerplate</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/infra-portal/pr-preview/pr-45/docs/category/json-schema">JSON Schema</a><button aria-label="Expand sidebar category &#x27;JSON Schema&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/infra-portal/pr-preview/pr-45/docs/knowledge-base/monitoring">Monitoring</a><button aria-label="Expand sidebar category &#x27;Monitoring&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/infra-portal/pr-preview/pr-45/docs/category/packages">Packages</a><button aria-label="Expand sidebar category &#x27;Packages&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/infra-portal/pr-preview/pr-45/docs/category/pipelines">DevOps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/infra-portal/pr-preview/pr-45/docs/knowledge-base/ts-server-boilerplate">TypeScript Server Boilerplate</a><button aria-label="Expand sidebar category &#x27;TypeScript Server Boilerplate&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/infra-portal/pr-preview/pr-45/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Jobnik</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p><img decoding="async" loading="lazy" alt="automated factory" src="/infra-portal/pr-preview/pr-45/assets/images/jobnik-dcef64f936145dde53a3ba27f230e324.jpg" width="1024" height="559" class="img_ev3q"></p>
<header><h1>Jobnik Job Management System Architecture</h1></header>
<p>This document provides a high-level architectural overview of the Jobnik Job Management system. It outlines the primary components, their roles, and how they integrate to facilitate distributed task management and workflow orchestration.</p>
<p>For detailed implementation guides, configuration references, and API documentation, please refer to the specific repositories linked in each section.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="system-overview">System Overview<a href="#system-overview" class="hash-link" aria-label="Direct link to System Overview" title="Direct link to System Overview">​</a></h2>
<p>Jobnik is a distributed job management ecosystem designed to handle complex, hierarchical workflows. It separates the orchestration logic (state management, queuing, persistence) from the execution logic (task processing), allowing for scalable and resilient distributed systems.</p>
<p>The architecture consists of three main pillars:</p>
<ol>
<li><strong>Jobnik Manager:</strong> The central service responsible for state and persistence.</li>
<li><strong>Jobnik SDK:</strong> The library handling communication, resilience, and type safety.</li>
<li><strong>Worker Boilerplate:</strong> A standardized scaffolding for building task-processing services.</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-job-manager">1. Job Manager<a href="#1-job-manager" class="hash-link" aria-label="Direct link to 1. Job Manager" title="Direct link to 1. Job Manager">​</a></h2>
<p>The Job Manager acts as the central orchestration service and the single source of truth for the system. It exposes a RESTful API that enables external services to create jobs, track progress, and manage task queues.</p>
<p><strong>Key Responsibilities:</strong></p>
<ul>
<li><strong>Hierarchical Data Management:</strong> Manages the relationships between <strong>Jobs</strong> (the root entity), <strong>Stages</strong> (logical groupings of tasks), and <strong>Tasks</strong> (atomic units of work).</li>
<li><strong>State Management:</strong> Enforces valid state transitions using internal state machines. This prevents invalid operations, such as adding tasks to a completed stage or processing a cancelled job.</li>
<li><strong>Persistence:</strong> Stores all workflow data, status history, and operational metadata in a PostgreSQL database.</li>
<li><strong>Queue Management:</strong> Implements priority-based task dequeuing logic, ensuring high-priority jobs are processed first.</li>
<li><strong>Task Health Management:</strong> Monitors and handles &#x27;forgotten&#x27; tasks to ensure no work becomes stale. This includes detecting tasks that have been in-progress for too long and recovering from worker failures.</li>
<li><strong>Observability:</strong> Emits standardized metrics (Prometheus) and distributed traces (OpenTelemetry) to monitor system health and request flows.</li>
</ul>
<p><a href="https://github.com/MapColonies/jobnik-manager" target="_blank" rel="noopener noreferrer">Link to Job Manager Repository</a></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-jobnik-sdk">2. Jobnik SDK<a href="#2-jobnik-sdk" class="hash-link" aria-label="Direct link to 2. Jobnik SDK" title="Direct link to 2. Jobnik SDK">​</a></h2>
<p>The Jobnik SDK is a TypeScript library that abstracts the complexity of communicating with the Job Manager. It provides a typed, resilient communication layer used by both producers (services that create work) and consumers (services that perform work).</p>
<p><strong>Key Components:</strong></p>
<ul>
<li><strong>Producer Client:</strong> A client designed for services that initiate workflows. It handles the creation of Jobs, Stages, and Tasks, automatically managing trace context propagation.</li>
<li><strong>Worker Client:</strong> A client designed for task processing services. It manages the task lifecycle loop: polling for tasks, executing business logic, and updating task status (Completed/Failed) upon conclusion.</li>
</ul>
<p><strong>Core Capabilities:</strong></p>
<ul>
<li><strong>Type Safety:</strong> Leverages TypeScript Generics to allow developers to define custom schemas for Job, Stage, and Task data. This ensures that payloads passed between Producers and Workers are typed and validated at compile time.</li>
<li><strong>Resilience:</strong> Built-in implementation of industry-standard stability patterns, including:
<ul>
<li><strong>Circuit Breakers:</strong> Prevents cascading failures when the Job Manager is under load.</li>
<li><strong>Exponential Backoff:</strong> Manages retry logic for polling and network requests.</li>
<li><strong>Graceful Shutdown:</strong> Handles signal termination to ensure active tasks are completed or released before the service stops.</li>
</ul>
</li>
<li><strong>Automated Observability:</strong> Automatically injects tracing headers into API calls and exposes worker-specific metrics (e.g., active tasks, task duration, success rates) without requiring manual instrumentation in the business logic.</li>
</ul>
<p><a href="/infra-portal/pr-preview/pr-45/docs/knowledge-base/packages/jobnik-sdk">Link to Jobnik SDK</a></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-worker-boilerplate">3. Worker Boilerplate<a href="#3-worker-boilerplate" class="hash-link" aria-label="Direct link to 3. Worker Boilerplate" title="Direct link to 3. Worker Boilerplate">​</a></h2>
<p>The Worker Boilerplate is a production-ready template repository designed to accelerate the development of new task-processing services. While not a runtime dependency, it serves as the standard starting point for building services that utilize the Jobnik SDK.</p>
<p><strong>Purpose:</strong></p>
<p>It provides a pre-configured environment that integrates the Jobnik SDK with standard infrastructure requirements, allowing developers to focus solely on implementing the specific business logic for a task (e.g., image processing, data ingestion).</p>
<p><strong>Included Scaffolding:</strong></p>
<ul>
<li><strong>Dependency Injection:</strong> Pre-wired setup using <code>tsyringe</code> for managing service dependencies.</li>
<li><strong>Configuration Management:</strong> Integration with standard configuration libraries for environment-based settings.</li>
<li><strong>SDK Integration:</strong> Example implementation of the SDK&#x27;s <code>Worker</code> client, demonstrating how to register task handlers and define custom types.</li>
<li><strong>Deployment Assets:</strong> Includes Dockerfiles and Helm charts aligned with infrastructure standards for rapid deployment.</li>
</ul>
<p><a href="/infra-portal/pr-preview/pr-45/docs/knowledge-base/jobnik/boilerplate">Link to Worker Boilerplate Repository</a></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="integration-flow">Integration Flow<a href="#integration-flow" class="hash-link" aria-label="Direct link to Integration Flow" title="Direct link to Integration Flow">​</a></h2>
</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/MapColonies/infra-portal/tree/master/docs/knowledge-base/jobnik/README.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/infra-portal/pr-preview/pr-45/docs/knowledge-base/config-management/default-configs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Default configs</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/infra-portal/pr-preview/pr-45/docs/knowledge-base/jobnik/boilerplate"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Boilerplate</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#system-overview" class="table-of-contents__link toc-highlight">System Overview</a></li><li><a href="#1-job-manager" class="table-of-contents__link toc-highlight">1. Job Manager</a></li><li><a href="#2-jobnik-sdk" class="table-of-contents__link toc-highlight">2. Jobnik SDK</a></li><li><a href="#3-worker-boilerplate" class="table-of-contents__link toc-highlight">3. Worker Boilerplate</a></li><li><a href="#integration-flow" class="table-of-contents__link toc-highlight">Integration Flow</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/infra-portal/pr-preview/pr-45/docs/knowledge-base">Knowledge Base</a></li><li class="footer__item"><a class="footer__link-item" href="/infra-portal/pr-preview/pr-45/docs/guides">Guides</a></li><li class="footer__item"><a class="footer__link-item" href="/infra-portal/pr-preview/pr-45/docs/what-we-did">What We Did</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Infra Portal, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>