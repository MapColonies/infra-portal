"use strict";(self.webpackChunkinfra_portal=self.webpackChunkinfra_portal||[]).push([[6339],{43543:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"knowledge-base/packages/jobnik-sdk/README","title":"Jobnik SDK","description":"TypeScript SDK for interacting with the Jobnik job management system. Provides type-safe clients for creating jobs, processing tasks, and monitoring workflows with built-in observability and resilience patterns.","source":"@site/docs/knowledge-base/packages/jobnik-sdk/README.md","sourceDirName":"knowledge-base/packages/jobnik-sdk","slug":"/knowledge-base/packages/jobnik-sdk/","permalink":"/infra-portal/pr-preview/pr-45/docs/knowledge-base/packages/jobnik-sdk/","draft":false,"unlisted":false,"editUrl":null,"tags":[],"version":"current","frontMatter":{"custom_edit_url":null},"sidebar":"knowledgeBaseSidebar","previous":{"title":"default","permalink":"/infra-portal/pr-preview/pr-45/docs/knowledge-base/packages/express-access-log-middleware/typedoc/functions/default"},"next":{"title":"index","permalink":"/infra-portal/pr-preview/pr-45/docs/knowledge-base/packages/jobnik-sdk/typedoc/"}}');var r=t(74848),i=t(28453);const a={custom_edit_url:null},o="Jobnik SDK",l={},c=[{value:"Features",id:"features",level:2},{value:"Installation",id:"installation",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Initialize the SDK",id:"initialize-the-sdk",level:3},{value:"Define Custom Types (Optional)",id:"define-custom-types-optional",level:3},{value:"Create Jobs (Producer)",id:"create-jobs-producer",level:3},{value:"Process Tasks (Worker)",id:"process-tasks-worker",level:3},{value:"Observability",id:"observability",level:2},{value:"Prometheus Metrics",id:"prometheus-metrics",level:3},{value:"OpenTelemetry Tracing",id:"opentelemetry-tracing",level:3},{value:"Configuration Options",id:"configuration-options",level:2},{value:"Documentation",id:"documentation",level:2},{value:"License",id:"license",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"jobnik-sdk",children:"Jobnik SDK"})}),"\n",(0,r.jsx)(n.p,{children:"TypeScript SDK for interacting with the Jobnik job management system. Provides type-safe clients for creating jobs, processing tasks, and monitoring workflows with built-in observability and resilience patterns."}),"\n",(0,r.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Type-Safe API"}),": Full TypeScript support with custom job and stage type definitions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Producer Client"}),": Create and manage jobs, stages, and tasks"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Worker Client"}),": Automated task processing with configurable concurrency"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Circuit Breaker Protection"}),": Built-in resilience for handling failures"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Observability"}),": Prometheus metrics and OpenTelemetry distributed tracing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Graceful Shutdown"}),": Coordinated shutdown with running task completion"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm install @map-colonies/jobnik-sdk\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Requirements"}),": Node.js >= 24"]}),"\n",(0,r.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,r.jsx)(n.h3,{id:"initialize-the-sdk",children:"Initialize the SDK"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { JobnikSDK } from '@map-colonies/jobnik-sdk';\n\nconst sdk = new JobnikSDK({\n  baseUrl: 'https://api.jobnik.example.com'\n  metricsRegistry: new Registry()\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"define-custom-types-optional",children:"Define Custom Types (Optional)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"interface MyJobTypes {\n  'image-processing': {\n    userMetadata: { userId: string };\n    data: { imageUrl: string };\n  };\n}\n\ninterface MyStageTypes {\n  'resize': {\n    userMetadata: { quality: number };\n    data: { width: number; height: number };\n    task: {\n      userMetadata: { batchId: string };\n      data: { sourceUrl: string; targetPath: string };\n    };\n  };\n}\n\nconst sdk = new JobnikSDK<MyJobTypes, MyStageTypes>({\n  baseUrl: 'https://api.jobnik.example.com'\n  metricsRegistry: new Registry()\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"create-jobs-producer",children:"Create Jobs (Producer)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const producer = sdk.getProducer();\n\n// Create a job\nconst job = await producer.createJob({\n  name: 'image-processing',\n  data: { imageUrl: 'https://example.com/image.jpg' },\n  userMetadata: { userId: 'user-123' },\n  priority: 'HIGH'\n});\n\n// Add a stage to the job\nconst stage = await producer.createStage(job.id, {\n  type: 'resize',\n  data: { width: 800, height: 600 },\n  userMetadata: { quality: 90 }\n});\n\n// Add tasks to the stage\nconst task = await producer.createTask(stage.id, {\n  data: { sourceUrl: 'https://example.com/image.jpg', targetPath: '/output/resized.jpg' },\n  userMetadata: { batchId: 'batch-1' }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"process-tasks-worker",children:"Process Tasks (Worker)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Define task handler\nconst taskHandler = async (task, context) => {\n  const { sourceUrl, targetPath } = task.data;\n  \n  context.logger.info('Processing task', { taskId: task.id });\n  \n  // Your processing logic here\n  await resizeImage(sourceUrl, targetPath);\n  \n  // Check for cancellation during shutdown\n  if (context.signal.aborted) {\n    throw new Error('Task cancelled');\n  }\n};\n\n// Create and start worker using the SDK\nconst worker = sdk.createWorker(\n  'resize',\n  taskHandler,\n  {\n    concurrency: 5,\n    backoffOptions: {\n      initialBaseRetryDelayMs: 1000,\n      maxDelayMs: 60000,\n      backoffFactor: 2\n    }\n  }\n);\n\nawait worker.start();\n\n// Graceful shutdown\nprocess.on('SIGTERM', async () => {\n  await worker.stop();\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"observability",children:"Observability"}),"\n",(0,r.jsx)(n.h3,{id:"prometheus-metrics",children:"Prometheus Metrics"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { Registry } from 'prom-client';\n\nconst registry = new Registry();\nconst sdk = new JobnikSDK({\n  baseUrl: 'https://api.jobnik.example.com',\n  metricsRegistry: registry\n});\n\n// Expose metrics endpoint\napp.get('/metrics', async (req, res) => {\n  res.set('Content-Type', registry.contentType);\n  res.send(await registry.metrics());\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"opentelemetry-tracing",children:"OpenTelemetry Tracing"}),"\n",(0,r.jsx)(n.p,{children:"The SDK automatically creates spans for all operations when OpenTelemetry is configured in your application. Trace context is propagated through jobs, stages, and tasks."}),"\n",(0,r.jsx)(n.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const sdk = new JobnikSDK({\n  baseUrl: string;                    // Required: Jobnik API base URL\n  httpClientOptions?: {               // Optional: HTTP client configuration\n    retry?: {                         // Retry configuration\n      maxRetries?: number;            // Maximum number of retries\n      statusCodes?: number[];         // HTTP status codes to retry\n      errorCodes?: string[];          // Error codes to retry\n      initialBaseRetryDelayMs?: number; // Initial base delay in ms\n      disableJitter?: boolean;        // Disable random jitter in delay\n      maxJitterFactor?: number;       // Maximum jitter factor\n    };\n    agentOptions?: Agent.Options;     // HTTP agent options\n  };\n  logger?: Logger;                    // Optional: Custom logger (defaults to NoopLogger)\n  metricsRegistry: Registry;          // Required: Prometheus registry for metrics\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"documentation",children:"Documentation"}),"\n",(0,r.jsxs)(n.p,{children:["Full API documentation is available at ",(0,r.jsx)(n.a,{href:"https://mapcolonies.github.io/jobnik-sdk/",children:"https://mapcolonies.github.io/jobnik-sdk/"})]}),"\n",(0,r.jsx)(n.h2,{id:"license",children:"License"}),"\n",(0,r.jsx)(n.p,{children:"ISC"}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["This page was generated from a remote source. you can find it on ",(0,r.jsx)(n.a,{href:"https://github.com/MapColonies/jobnik-sdk/blob/master/README.md",children:"https://github.com/MapColonies/jobnik-sdk/blob/master/README.md"})]})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var s=t(96540);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);