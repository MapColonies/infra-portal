"use strict";(self.webpackChunkinfra_portal=self.webpackChunkinfra_portal||[]).push([[7102],{819:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>l,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"id":"knowledge-base/packages/error-express-handler/README","title":"error-express-handler","description":"This package exports a middleware for express that handles Error and HttpError(custom package type).","source":"@site/docs/knowledge-base/packages/error-express-handler/README.md","sourceDirName":"knowledge-base/packages/error-express-handler","slug":"/knowledge-base/packages/error-express-handler/","permalink":"/infra-portal/pr-preview/pr-38/docs/knowledge-base/packages/error-express-handler/","draft":false,"unlisted":false,"editUrl":null,"tags":[],"version":"current","frontMatter":{"custom_edit_url":null},"sidebar":"knowledgeBaseSidebar","previous":{"title":"Config","permalink":"/infra-portal/pr-preview/pr-38/docs/knowledge-base/packages/config/"},"next":{"title":"index","permalink":"/infra-portal/pr-preview/pr-38/docs/knowledge-base/packages/error-express-handler/typedoc/"}}');var a=n(4848),t=n(8453);const o={custom_edit_url:null},l="error-express-handler",d={},i=[{value:"Install",id:"install",level:2},{value:"API documentation",id:"api-documentation",level:2},{value:"Usage",id:"usage",level:2},{value:"Flow",id:"flow",level:2}];function p(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",mermaid:"mermaid",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"error-express-handler",children:"error-express-handler"})}),"\n",(0,a.jsx)(r.p,{children:"This package exports a middleware for express that handles Error and HttpError(custom package type)."}),"\n",(0,a.jsx)(r.h2,{id:"install",children:"Install"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-sh",children:"npm install --save @map-colonies/error-express-handler\n"})}),"\n",(0,a.jsx)(r.h2,{id:"api-documentation",children:"API documentation"}),"\n",(0,a.jsxs)(r.p,{children:["Check the autogenerated documentation ",(0,a.jsx)(r.a,{href:"https://mapcolonies.github.io/error-express-handler/",children:"here"}),"."]}),"\n",(0,a.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,a.jsxs)(r.p,{children:["Add the handler as the last middleware, so any error forwarded by the controllers will be handled.\nIf the value of ",(0,a.jsx)(r.code,{children:"NODE_ENV"})," is production the error message will be redacted and a generic one will be sent instead.\nIn development, in addition to the error message, the stack trace of the error will be included in the response."]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-ts",children:"import express from 'express';\nimport { getErrorHandlerMiddleware } from '@map-colonies/error-express-handler';\n\nprocess.env.NODE_ENV = 'development';\n\nconst app = express();\n\napp.use('/meow', fn);\n\napp.use(getErrorHandlerMiddleware());\n\napp.listen(8080, function() {\n    console.log('server is up');\n});\n"})}),"\n",(0,a.jsx)(r.h2,{id:"flow",children:"Flow"}),"\n",(0,a.jsx)(r.mermaid,{value:'flowchart TD\n    A@{ label: "NODE_ENV=\'production\'" } -- true --\x3e B["error implements HttpError"]\n    A -- false --\x3e C["error implements HttpError"]\n    B -- true --\x3e D["Status code: err.StatusCode<br>body: {\ufb02\xb0\xb034\xb6\xdfmessage\ufb02\xb0\xb034\xb6\xdf:\ufb02\xb0\xb034\xb6\xdferr.message\ufb02\xb0\xb034\xb6\xdf}"]\n    B -- false --\x3e E["Status code: 500<br>body: {\ufb02\xb0\xb034\xb6\xdfmessage\ufb02\xb0\xb034\xb6\xdf:\ufb02\xb0\xb034\xb6\xdfInternal Server Error\ufb02\xb0\xb034\xb6\xdf}"]\n    C -- true --\x3e F["Status code: err.StatusCode<br>body: {\ufb02\xb0\xb034\xb6\xdfmessage\ufb02\xb0\xb034\xb6\xdf:\ufb02\xb0\xb034\xb6\xdferr.message\ufb02\xb0\xb034\xb6\xdf}"]\n    C -- false --\x3e G["Status code: 500<br>body: {\ufb02\xb0\xb034\xb6\xdfmessage\ufb02\xb0\xb034\xb6\xdf:\ufb02\xb0\xb034\xb6\xdfInternal Server Error\ufb02\xb0\xb034\xb6\xdf, \ufb02\xb0\xb034stacktrace\ufb02\xb0\xb034:err.stack }"]\n'}),"\n",(0,a.jsx)(r.admonition,{type:"note",children:(0,a.jsxs)(r.p,{children:["This page was generated from a remote source. you can find it on ",(0,a.jsx)(r.a,{href:"https://github.com/MapColonies/error-express-handler/blob/master/README.md",children:"https://github.com/MapColonies/error-express-handler/blob/master/README.md"})]})})]})}function c(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>l});var s=n(6540);const a={},t=s.createContext(a);function o(e){const r=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);